{% extends 'fragments/base.html' %}
{% load static %}

{% block main %}
    {% if request.user.is_authenticated %}
        <div class="container">
            <div class="my-3 p-3 bg-body rounded shadow-sm">
                <h3 class="pb-2">Пошук залізничних квитків</h3>
                <div class="bg-body rounded shadow-sm py-3">
                    <form class="row g-4 p-3" id="createCheckerForm">
                        <div class="row">
                            <div class="col-md-auto col-sm-12">
                                <div class="col-auto">
{#                                    <label for="search-from" class="form-label ms-2">from</label>#}
                                    <input type="text" class="form-control" name="from_station" id="search-from" placeholder="Звідки виїзд?">
                                    <ul id="search-from-results" class="position-absolute text-bg-secondary pe-2"></ul>
                                </div>
                            </div>
                            <div class="col-md-auto col-sm-12">
                                <div class="col-auto">
{#                                    <label for="search-to" class="form-label ms-2">to</label>#}
                                    <input type="text" class="form-control" name="to_station" id="search-to" placeholder="Куди прямуєте?">
                                    <ul id="search-to-results" class="position-absolute text-bg-secondary pe-2"></ul>
                                </div>
                            </div>
                            <div class="col-md-auto col-sm-12">
                                <div class="col-auto">
{#                                    <label class="form-label ms-2">dates</label>#}
                                    <input type="text" class="form-control" name="date_at" aria-label="datepicker" placeholder="Дата"/>
                                </div>
                            </div>
                            <div class="col-md-auto col-sm-12">
                                <div class="col-auto">
{#                                    <label class="form-label ms-2"></label>#}
                                    <button class="btn btn-primary form-control CreateCheckerBtn">Пошук</button>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>
            </div>

            <div class="my-3 p-3 bg-body rounded shadow-sm">
                <h3 class="pb-2">Квитки За напрямком:</h3>
                <div class="bg-body rounded shadow-sm">
                    <table class="table">
                        <thead>
                            <tr class="text-center">
                                <th class="col-auto text-primary-emphasis border" rowspan="2">Дата відправлення</th>
                                <th class="col-auto text-primary-emphasis border" rowspan="2">Час відправлення</th>
                                <th class="col-auto text-primary-emphasis border" rowspan="2">Дата прибуття</th>
                                <th class="col-1 text-primary-emphasis border" rowspan="2">Час прибуття</th>
                                <th class="col-1 text-primary-emphasis border" rowspan="2">5</th>
                                <th class="col-auto text-primary-emphasis border" rowspan="2">6</th>
                                <th class="col-auto text-primary-emphasis border" colspan="2">7</th>
                                <th class="col-auto text-primary-emphasis border" colspan="2">8</th>
                                <th class="col-1 text-primary-emphasis border" rowspan="2">9</th>
                                <th class="col-1 text-primary-emphasis border" rowspan="2">10</th>
                                <th class="col-auto text-primary-emphasis border" rowspan="2">11</th>
                                <th class="col-auto text-primary-emphasis border" rowspan="2">12</th>
                                <th class="col-1 border"></th>
                            </tr>
                            <tr class="text-center">
                                <th class="col-auto text-primary-emphasis border">Відправлення</th>
                                <th class="col-auto text-primary-emphasis border">Прибуття</th>
                                <th class="col-auto text-primary-emphasis border">date</th>
                                <th class="col-auto text-primary-emphasis border">time</th>
                            </tr>
                        </thead>

                        {% if checkers %}
                            <tbody class="text-center" id="checkersBodyTable">
                            {% for checker in checkers %}
                                <tr>
                                    <td>{{ checker.from_station.name }}</td>
                                    <td>{{ checker.to_station.name }}</td>
                                    <td>{{ checker.date_at|date:"Y-m-d" }} </td>
                                    <td>{{ checker.time_at|date:"H:i" }}</td>
                                    <td>
                                        <div class="form-check d-flex justify-content-center">
                                            <input class="form-check-input activeCheckerButton" type="checkbox"
                                                   value="{{ checker.is_active }}" aria-label="checker_active_state"
                                                   data-checker_id="{{ checker.id }}"
                                                    {% if checker.is_active %} checked {% endif %}>
                                        </div>
                                    </td>
                                    <td>
                                        <div>
                                            <small class="text-secondary text-opacity-50" title="last checked">
                                                {{ checker.updated_at|date:"Y-m-d H:i" }}
                                            </small>

                                            {% if checker.is_available %}
                                                <i class="p-2 text-success fs-5 bi bi-check2-all"
                                                   title="available"></i>
                                            {% else %}
                                                <i class="p-2 text-danger bi bi-ban"
                                                   title="not available"></i>
                                            {% endif %}
                                        </div>
                                    </td>
                                    <td>
                                        <div class="input-group d-flex justify-content-center">
                                            <button title="trash" class="nav-link bi bi-trash mx-1 deleteCheckerButton"
                                                    data-checker_id="{{ checker.id }}">
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        {% endif %}
                    </table>
                </div>
            </div>
        </div>

{#        <script>#}
{#            window.StationUrl = "{% url 'tickets_ua:api-station' %}"#}
{#            window.ChekerUrl = "{% url 'tickets_ua:api-checker' %}"#}
{#        </script>#}

{#        <script>#}
{#            $('#range-time').on('input', function () {#}
{#                const time = $('#range-time').val()#}
{#                $('#range-time-value').val((time < 10 ? "0" + time : time) + ":00")#}
{#            });#}
{#        </script>#}

{#        <script src="{% static '/js/moment.min.js' %}"></script>#}
{#        <script src="{% static '/js/daterangepicker.js' %}"></script>#}
{#        <script>#}
{#            $(function () {#}
{#                $('input[name="date_at"]').daterangepicker({#}
{#                    opens: 'left',#}
{#                    startDate: moment(),#}
{#                    minDate: moment(),#}
{#                    endDate: moment(),#}
{#                    maxDate: moment().add(10, 'day'),#}
{#                    locale: {#}
{#                        format: 'YYYY-MM-DD'#}
{#                    }#}
{#                });#}
{#            });#}
{#        </script>#}

{#        <script src="{% static '/js/calc.js' %}"></script>#}
{#        <script src="{% static '/js/ajax.js' %}"></script>#}
{#        <script src="{% static '/js/notify.js' %}"></script>#}

        {% csrf_token %}
{#        <script src="{% static '/js/tickets_ua/station.js' %}"></script>#}
{#        <script src="{% static '/js/tickets_ua/checker.js' %}"></script>#}

    {% endif %}
{% endblock %}